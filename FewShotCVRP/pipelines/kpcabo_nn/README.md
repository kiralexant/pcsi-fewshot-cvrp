# Kernel-PCA-BO Neural Controller Pipeline

Этот модуль предоставляет модульную реализацию обучения нейросетевого контроллера параметров эволюционного алгоритма с использованием Kernel-PCA Bayesian Optimization (KPCA-BO).

## Состав папки

- `config.py` — датаклассы и загрузчик JSON-конфигураций.
- `simulation.py` — параллельная симуляция для CVRP и фабрика оценщиков.
- `snapshotting.py` — обёртка над KPCA-BO с сохранением снапшотов.
- `pipeline.py` — высокоуровневый конвейер обучения.
- `run_cvrp_pipeline.py` — CLI для запуска обучения по готовой конфигурации.

## Быстрый старт

```bash
python -m FewShotCVRP.pipelines.kpcabo_nn.run_cvrp_pipeline   --config FewShotCVRP/examples/params_search/kpca-bo-nn-config.json
```

После завершения снапшоты и результаты будут сохранены в каталоге `outputs/<timestamp>/per-instance-param-control/`.

## Адаптация под другие задачи

1. **Загрузите собственные инстансы.** В конфигурации укажите список `instances` и при необходимости измените пути.
2. **Переопределите фабрику оценщиков.** Реализуйте класс с интерфейсом `BatchEvaluator` и передайте его в `KernelPCANNTrainingPipeline`.
3. **Настройте эволюционный алгоритм.** В секции `simulation` укажите другой оператор мутаций, размер окна, границы `theta` и т.д.
4. **Измените конфигурацию KPCA-BO.** Параметры в секциях `kpcabo` и `bo_embedding` подаются напрямую в реализованный в статье алгоритм.

Благодаря такому разбиению можно быстро заменить эволюционный алгоритм, нейросетевую модель или даже всю задачу, сохранив при этом общий процесс обучения.
